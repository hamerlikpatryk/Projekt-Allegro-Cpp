#include <allegro5\allegro.h>
#include <allegro5\allegro_image.h>
#include <allegro5\allegro_primitives.h>

int main()
{
	ALLEGRO_DISPLAY * display;
	ALLEGRO_EVENT_QUEUE * queue;
	ALLEGRO_TIMER * timer;

	ALLEGRO_COLOR blue = al_map_rgb(44, 117, 255);
	ALLEGRO_COLOR playerColor = blue;

	ALLEGRO_BITMAP *menu = NULL;
	ALLEGRO_BITMAP *nowagraakt = NULL;				//bimapy w menu
	ALLEGRO_BITMAP *wczytajpoziomakt = NULL;
	ALLEGRO_BITMAP *autorzyakt = NULL;
	ALLEGRO_BITMAP *wyjscieakt = NULL;

	ALLEGRO_BITMAP *wczytajpoziom = NULL;          // bitmapy po przejsciu z menu
	ALLEGRO_BITMAP *autorzy = NULL;	

	ALLEGRO_BITMAP * postac1 = NULL;
	ALLEGRO_BITMAP *okno1 = NULL; //nowa gra
	ALLEGRO_BITMAP *okno2 = NULL;
	ALLEGRO_BITMAP *okno3 = NULL; 
	ALLEGRO_BITMAP *podloga1 = NULL;
	ALLEGRO_BITMAP *podloga2 = NULL;
	ALLEGRO_BITMAP *podloga3 = NULL;
	ALLEGRO_BITMAP *wrog1 = NULL;
	ALLEGRO_BITMAP *wrog2 = NULL;
	ALLEGRO_BITMAP *wrog3 = NULL;
	ALLEGRO_BITMAP *wrog4 = NULL;
	ALLEGRO_BITMAP *karczmarz = NULL;
	ALLEGRO_BITMAP *stol = NULL;
	ALLEGRO_BITMAP *krzeslo1 = NULL;
	ALLEGRO_BITMAP *krzeslo2 = NULL;
	ALLEGRO_BITMAP *bar = NULL;
	ALLEGRO_BITMAP *szafa = NULL;
	ALLEGRO_BITMAP *lampa = NULL;
	ALLEGRO_BITMAP *brama = NULL;
	ALLEGRO_BITMAP *lutnia = NULL; 

	al_init();
	display = al_create_display(640, 480);
	queue = al_create_event_queue();
	timer = al_create_timer(1.0 / 60);

	al_install_mouse();
	al_install_keyboard();

	al_register_event_source(queue, al_get_mouse_event_source());
	al_register_event_source(queue, al_get_keyboard_event_source());
	al_register_event_source(queue, al_get_display_event_source(display));
	al_register_event_source(queue, al_get_timer_event_source(timer));

	//al_hide_mouse_cursor(display);


	al_start_timer(timer); 

	al_init_primitives_addon();
	al_init_image_addon();

	menu = al_load_bitmap("menu.png");

	nowagraakt = al_load_bitmap("nowagraakt.png");
	wczytajpoziomakt = al_load_bitmap("wczytajpoziomakt.png");
	autorzyakt = al_load_bitmap("autorzyakt.png");
	wyjscieakt = al_load_bitmap("wyjscieakt.png");

	autorzy = al_load_bitmap("autorzy.png");
	wczytajpoziom = al_load_bitmap("wczytajpoziom.png");

	postac1 = al_load_bitmap("postac1.png");
	okno1 = al_load_bitmap("okno1.png");
	okno2 = al_load_bitmap("okno2.png");
	okno3 = al_load_bitmap("okno3.png");
	podloga1 = al_load_bitmap("podloga1.png");
	podloga2 = al_load_bitmap("podloga2.png");
	podloga3 = al_load_bitmap("podloga3.png");
	wrog1 = al_load_bitmap("wrog1.png");
	wrog2 = al_load_bitmap("wrog2.png");
	wrog3 = al_load_bitmap("wrog3.png");
	wrog4 = al_load_bitmap("wrog4.png");
	szafa = al_load_bitmap("szafa.png");
	lampa = al_load_bitmap("lampa.png");
	brama = al_load_bitmap("brama.png");
	karczmarz = al_load_bitmap("karczmarz.png");
	stol = al_load_bitmap("stol.png");
	krzeslo1 = al_load_bitmap("krzeslo1.png");
	krzeslo2 = al_load_bitmap("krzeslo2.png");
	bar = al_load_bitmap("bar.png");
	lutnia = al_load_bitmap("lutnia.png");

	
	float postac_x = 0, postac_y = 0;
	int width = al_get_display_width(display);
	int height = al_get_display_height(display);


	int menu_on = 1;
	int nowagra_on = 0;
	int autorzy_on = 0;
	int wczytajpoziom_on = 0;

	bool running = true;

	int x = 10, y = 10, moveSpeed = 5;

	while (running)

	{
		ALLEGRO_EVENT event;
		al_wait_for_event(queue, &event);

		if (event.type == ALLEGRO_EVENT_DISPLAY_CLOSE)
			running = false;

		//mouse
		if (event.type == ALLEGRO_EVENT_MOUSE_AXES)
		{
			x = event.mouse.x;
			y = event.mouse.y;

		}
		//keyboard
		ALLEGRO_KEYBOARD_STATE  keyState;
		al_get_keyboard_state(&keyState);

		if (al_key_down(&keyState, ALLEGRO_KEY_RIGHT))
			if (al_key_down(&keyState, ALLEGRO_KEY_LCTRL))
				postac_x += 20;
			else
				postac_x += 10;

		if (al_key_down(&keyState, ALLEGRO_KEY_LEFT))
			if (al_key_down(&keyState, ALLEGRO_KEY_LCTRL))
				postac_x += -20;
			else
				postac_x += -10;

		if (al_key_down(&keyState, ALLEGRO_KEY_UP))
			postac_y += 10; //jump

		if (al_key_down(&keyState, ALLEGRO_KEY_DOWN))
			postac_y += 10;

		if (al_key_down(&keyState, ALLEGRO_KEY_SPACE))
			//postac_y //atak
			;

		if (event.type == ALLEGRO_EVENT_TIMER)
		{
			al_clear_to_color(al_map_rgba_f(0, 0, 0, 0));
		}

		/////////////////////////////////////////////////////////////////////// BITMAPY OPCJI MENU // widok menu
		if (menu_on == 1)
		{
			al_draw_bitmap(menu, 0, 0, NULL);								//rysowanie menu
			al_draw_rectangle(x, y, x + 10, y + 10, playerColor, 1);
																			// event po najechaniu i kliknięciu menu
			if (x > 160 && x < 390 && y >70 && y < 130)
			{
				al_draw_bitmap(nowagraakt, 160, 70, NULL);
				al_draw_rectangle(x, y, x + 10, y + 10, playerColor, 1);
				if (event.type == ALLEGRO_EVENT_MOUSE_BUTTON_DOWN)
				{
					if (event.mouse.button & 1)
					{
						nowagra_on = 1;
						menu_on = 0;
					}
				}
			}
			if (x > 215 && x < 405 && y >150 && y < 200)
			{
				al_draw_bitmap(autorzyakt, 180, 130, NULL);
				al_draw_rectangle(x, y, x + 10, y + 10, playerColor, 1);
				if (event.type == ALLEGRO_EVENT_MOUSE_BUTTON_DOWN)
				{
					if (event.mouse.button & 1)
					{
						autorzy_on = 1;
						menu_on = 0;
					}
				}
			}
			if (x > 150 && x < 500 && y >200 && y < 250)
			{
				al_draw_bitmap(wczytajpoziomakt, 150, 200, NULL);
				al_draw_rectangle(x, y, x + 10, y + 10, playerColor, 1);
				if (event.type == ALLEGRO_EVENT_MOUSE_BUTTON_DOWN)
				{
					if (event.mouse.button & 1)
					{
						wczytajpoziom_on = 1;
						menu_on = 0;
					}
				
				}
			}
			if (x > 150 && x < 530 && y >250 && y < 370)
			{
				al_draw_bitmap(wyjscieakt, 150, 250, NULL);
				al_draw_rectangle(x, y, x + 10, y + 10, playerColor, 1);
				if (event.type == ALLEGRO_EVENT_MOUSE_BUTTON_DOWN)
				{
					if (event.mouse.button & 1)
						running = false;
				}
			}
		}
		//////////////////////////////////// EVENTY PO KLIKNIĘCIU NOWEJ GRY
		if (nowagra_on == 1)
		{
			al_draw_bitmap(okno1, 0, 0, NULL);  
			al_draw_bitmap(podloga1, 0, 335, NULL);
			al_draw_bitmap(postac1, 265, 257 , NULL);
			al_draw_bitmap(bar, 131, 272, NULL); //+62
			al_draw_bitmap(karczmarz, 70, 191 + 63, NULL);
			al_draw_bitmap(krzeslo1, 422, 221 + 63, NULL); //7
			al_draw_bitmap(krzeslo1, 641, 221 + 63, NULL);
			al_draw_bitmap(krzeslo1, 825, 221 + 63, NULL);
			al_draw_bitmap(krzeslo1, 1095, 221 + 63, NULL);
			al_draw_bitmap(krzeslo1, 1275, 221 + 63, NULL);
			al_draw_bitmap(krzeslo1, 1492, 221 + 63, NULL);
			al_draw_bitmap(krzeslo1, 1731, 221 + 63, NULL); //
			al_draw_bitmap(krzeslo2, 996, 221 + 63, NULL); //4
			al_draw_bitmap(krzeslo2, 1388, 221 + 63, NULL);
			al_draw_bitmap(krzeslo2, 1660, 221 + 63, NULL);
			al_draw_bitmap(krzeslo2, 2004, 221 + 63, NULL);
			al_draw_bitmap(stol, 453, 240 + 63, NULL); //4
			al_draw_bitmap(stol, 851, 240 + 63, NULL);
			al_draw_bitmap(stol, 1524, 240 + 63, NULL);
			al_draw_bitmap(stol, 1847, 240 + 63, NULL);
			al_draw_bitmap(wrog1, 420, 182 + 63, NULL);  //15 wrogow
			al_draw_bitmap(wrog1, 501, 201 + 63, NULL);
			al_draw_bitmap(wrog1, 729, 234 + 63, NULL);
			al_draw_bitmap(wrog1, 781, 234 + 63, NULL);
			al_draw_bitmap(wrog1, 910, 201 + 63, NULL);
			al_draw_bitmap(wrog1, 1042, 234 + 63, NULL);
			al_draw_bitmap(wrog1, 1094, 182 + 63, NULL);
			al_draw_bitmap(wrog1, 1185, 234 + 63, NULL);
			al_draw_bitmap(wrog1, 1326, 234 + 63, NULL);
			al_draw_bitmap(wrog1, 1448, 234 + 63, NULL);
			al_draw_bitmap(wrog1, 1489, 182 + 63, NULL);
			al_draw_bitmap(wrog1, 1586, 201 + 63, NULL);
			al_draw_bitmap(wrog1, 1790, 234 + 63, NULL);
			al_draw_bitmap(wrog1, 1899, 201 + 63, NULL);
			al_draw_bitmap(wrog1, 2087, 234 + 63, NULL); // 
			al_draw_bitmap(wrog2, 2163, 197 + 63, NULL);
			al_draw_bitmap(lutnia, 2201, 237 + 63, NULL);


		}
		//////////////////////////////////// EVENTY PO KLIKNIĘCIU AUTORÓW
		if (autorzy_on == 1)
		{
			al_draw_bitmap(autorzy, 0, 0, NULL);
			al_draw_rectangle(x, y, x + 10, y + 10, playerColor, 1);
			if (x > 0 && x < 160 && y >0 && y < 90)
				if (event.type == ALLEGRO_EVENT_MOUSE_BUTTON_DOWN)
				{
					if (event.mouse.button & 1)
					{
						autorzy_on = 0;
						menu_on = 1;
					}
				}
		}	
		//////////////////////////////////// EVENTY PO KLIKNIĘCIU WCZYTAJ POZIOM
		if (wczytajpoziom_on == 1)
		{
			al_draw_bitmap(wczytajpoziom, 0, 0, NULL);
			al_draw_rectangle(x, y, x + 10, y + 10, playerColor, 1);
			if (x > 0 && x < 160 && y >0 && y < 90)
				if (event.type == ALLEGRO_EVENT_MOUSE_BUTTON_DOWN)
				{
					if (event.mouse.button & 1)
					{
						wczytajpoziom_on = 0;
						menu_on = 1;
					}
				}
		}


		al_flip_display();
	}

	al_destroy_display(display);
	al_uninstall_keyboard();
	al_uninstall_mouse();
	al_destroy_timer(timer);
	al_destroy_bitmap(menu);
	al_destroy_bitmap(nowagraakt);
	al_destroy_bitmap(wczytajpoziomakt);
	al_destroy_bitmap(autorzyakt);
	al_destroy_bitmap(wyjscieakt);
	al_destroy_bitmap(autorzy);
	al_destroy_bitmap(wczytajpoziom);
	al_destroy_bitmap(postac1);
	al_destroy_bitmap(okno1);
	al_destroy_bitmap(okno2);
	al_destroy_bitmap(okno3);
	al_destroy_bitmap(podloga1);
	al_destroy_bitmap(podloga2);
	al_destroy_bitmap(podloga3);
	al_destroy_bitmap(wrog1);
	al_destroy_bitmap(wrog2);
	al_destroy_bitmap(wrog3);
	al_destroy_bitmap(wrog4);
	al_destroy_bitmap(szafa);
	al_destroy_bitmap(lampa);
	al_destroy_bitmap(brama);
	al_destroy_bitmap(lutnia);

	return 0;
}
